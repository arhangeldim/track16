Добавление пароля с некоторыми символами конфликтует. надо сделать prepared statement.

При регистрации не получается нормальный юзер. Надо доставать ключ из базы.